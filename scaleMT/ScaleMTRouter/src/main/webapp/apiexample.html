<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>Apertium API mashup example</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript" src="http://api.apertium.org/JSLibrary.jsp?key=YOURAPIKEY"></script>
    <script type="text/javascript">

        //Search in twitter
        function search(query)
        {
            var url = "http://search.twitter.com/search.json?lang=en&callback=twittercallback&q="+escape(query);
            // this shows dynamic script insertion
            var script = document.createElement('script');
            script.setAttribute('src', url);
            document.getElementsByTagName('head')[0].appendChild(script);
            document.getElementById('results').innerHTML="Searching..."
        }

        //Process twitter response: show the tweets and call apertium web service to translate them
        function twittercallback(data)
        {
            var newHtml="";
            var resultsArray=data.results;
            for(var i=0; i<resultsArray.length; i++)
            {
                newHtml=newHtml+"<p>"+resultsArray[i].created_at+", from <strong>"+resultsArray[i].from_user+"</strong>:</p><p><i>Original</i>: "+resultsArray[i].text+'</p><p><i>Translation</i>: <span id="translation'+i+'"></span></p><hr/>';
            }
            document.getElementById('results').innerHTML=newHtml;


            for(i=0; i<resultsArray.length; i++)
            {
                 translate(resultsArray[i].text,'translation'+i)
            }
        }

        //Translates a text and puts it the given element
        function translate(text,element)
        {
             apertium.translate(text,'en','es',function(data){
                    if(!data.error)
                    {
                        document.getElementById(element).innerHTML=data.translation;
                    }
                    else
                        alert(data.error.code);
                });
        }
    </script>
  </head>
  <body>
      <h1>Apertium API example</h1>
      <p>Searches in <a href="http://twitter.com">Twitter</a> and translates the tweets from English to Spanish</p>
      <button id="search" onclick="search(document.getElementById('query').value);">Search</button> <input type="text" id="query"/>
      <div id="results">
      </div>
  </body>
</html>
